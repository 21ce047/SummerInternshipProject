<!DOCTYPE html>
<html>
<head>
    <link rel="icon" href="../public/img/image-2.png" type="image">
    <title>Analytics | Report</title>
    <link rel="stylesheet" type="text/css" href="../public/css/style4.css">
    <script>
        function filterTable() {
            const table = document.getElementById('student-table');
            const rows = Array.from(table.querySelectorAll('tr'));
            const select = document.getElementById('filter-select');
            const selectedOption = select.options[select.selectedIndex].value;

            rows.shift(); // Remove the header row from filtering

            rows.forEach((row) => {
                const statusCell = row.querySelector('td:last-child').textContent;
                if (selectedOption === 'all' || statusCell.toLowerCase() === selectedOption) {
                    row.style.display = 'table-row';
                } else {
                    row.style.display = 'none';
                }
            });
        }
    </script>
</head>
<body>
    <div class="download-section">
        <form action="/generate-report" method="post">
            <label>Generate Report:</label>
            <select name="format">
                <option value="excel">Excel (XLSX)</option>
                <option value="pdf">PDF</option>
            </select>
            <button type="submit">Download</button>
        </form>
    </div>
    <div class="content">
        <h1 align="center">Students List</h1>
        <label for="filter-select">Filter by Status:</label>
        <select id="filter-select" onchange="filterTable()">
            <option value="all">All</option>
            <option value="approved">Approved</option>
            <option value="rejected">Rejected</option>
            <option value="Pending">Pending</option>
        </select>
        <table id="student-table">
            <tr>
                <th>ID</th>
                <th>Name</th>
                <th>View</th>
                <th>Status</th>
            </tr>
            <% students.forEach((student) => { %>
                <tr>
                    <td><%= student.StudentID %></td>
                    <td><%= student.StudentName %></td>
                    <td>
                        <a href="/viewdetails?StudentID=<%= student.StudentID %>">View</a>
                    </td>
                    <td id="status-<%= student.StudentID %>"><%= student.Status %></td>
                </tr>
            <% }); %>
        </table>
    </div>
</body>
</html>
